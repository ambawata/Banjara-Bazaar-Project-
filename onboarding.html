<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Banjara Bazaar - Seller Onboarding</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght=700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fefce8; /* yellow-50 */ }
        .hidden { display: none; }
        
        /* Form Styles */
        .form-input { border: 1px solid #d1d5db; border-radius: 0.5rem; padding: 0.75rem; width: 100%; transition: all 0.2s; }
        .form-input:focus { border-color: #facc15; /* yellow-400 */ box-shadow: 0 0 0 3px rgba(250, 204, 21, 0.4); outline: none; }
        .form-input.invalid { border-color: #ef4444; }
        .error-message { color: #dc2626; font-size: 0.8rem; margin-top: 0.25rem; min-height: 1rem; }

        /* Progress Bar Style */
        .progress-bar { display: flex; align-items: flex-start; justify-content: space-between; font-weight: 600; }
        .progress-step { text-align: center; color: #9ca3af; /* gray-400 */ width: 60px; }
        .progress-circle { width: 2rem; height: 2rem; border-radius: 9999px; background-color: #e5e7eb; /* gray-200 */ display: flex; align-items: center; justify-content: center; margin: 0 auto; transition: all 0.3s; }
        .progress-label { font-size: 0.75rem; margin-top: 0.5rem; }
        .progress-line { flex-grow: 1; height: 2px; background-color: #e5e7eb; margin: 1rem -1rem 0 -1rem; }
        .progress-step.active .progress-circle { background-color: #facc15; color: black; }
        .progress-step.active .progress-label { color: #ca8a04; /* yellow-600 */ }
        .progress-step.completed .progress-circle { background-color: #facc15; color: black; }
        .progress-step.completed .progress-label { color: #ca8a04; }
        .progress-step.completed .progress-line { background-color: #facc15; }

        /* File Upload UI */
        .file-upload-wrapper { border: 2px dashed #d1d5db; border-radius: 0.5rem; padding: 1rem; text-align: center; }
        .file-preview { display: flex; align-items: center; justify-content: space-between; background-color: #f3f4f6; padding: 0.5rem 1rem; border-radius: 0.5rem; }

        /* Popup */
        .popup-overlay { position: fixed; inset: 0; background-color: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 50; }
        .popup-card { background-color: white; padding: 2rem; border-radius: 1rem; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; max-width: 400px; }
    </style>
</head>
<body>

    <div id="app-container">

        <div id="view-login">
            <div class="min-h-screen flex items-center justify-center px-4">
                <div class="bg-white rounded-2xl shadow-xl w-full max-w-md p-8">
                    <h2 class="text-3xl font-bold text-center mb-2">Seller Login</h2>
                    <p class="text-center text-gray-500 mb-8">Enter your mobile number to begin.</p>
                    <form id="loginForm" class="space-y-6">
                        <div>
                            <label for="login-mobile" class="font-medium">Mobile Number</label>
                            <input type="tel" id="login-mobile" required class="form-input mt-1" placeholder="10-digit mobile number">
                        </div>
                        <button type="submit" class="w-full bg-yellow-400 hover:bg-yellow-500 text-black font-semibold py-3 rounded-lg shadow-md transition-transform transform hover:scale-105">
                            Send OTP
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div id="view-onboarding" class="hidden">
            <div class="min-h-screen flex items-center justify-center px-4 py-12">
                <div class="bg-white rounded-2xl shadow-xl w-full max-w-xl p-8 space-y-8">
                    <div class="progress-bar">
                        <div id="progress-step-1" class="progress-step completed"><div class="progress-circle">âœ“</div><p class="progress-label">Login</p></div>
                        <div id="progress-line-1" class="progress-line completed"></div>
                        <div id="progress-step-2" class="progress-step active"><div class="progress-circle">2</div><p class="progress-label">Business</p></div>
                        <div id="progress-line-2" class="progress-line"></div>
                        <div id="progress-step-3" class="progress-step"><div class="progress-circle">3</div><p class="progress-label">Docs</p></div>
                    </div>

                    <div id="onboarding-step-2">
                        <h2 class="text-2xl font-bold text-center mb-4">Step 2: Business Details</h2>
                        <form id="businessDetailsForm" class="space-y-4">
                            <div><label class="font-medium" for="brandName">Brand Name</label><input type="text" id="brandName" required class="form-input mt-1" placeholder="e.g., Jodhpur Crafts"></div>
                            
                            <div class="space-y-4">
                                <p class="font-medium">GST Details</p>
                                <div class="flex gap-4">
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="radio" name="gst-option" id="has-gstin" value="gstin" checked class="text-yellow-400">
                                        <span>I have a GSTIN</span>
                                    </label>
                                    <label class="flex items-center space-x-2 cursor-pointer">
                                        <input type="radio" name="gst-option" id="need-enrollment" value="enrollment" class="text-yellow-400">
                                        <span>I need an Enrollment ID</span>
                                    </label>
                                </div>

                                <div id="gstin-section">
                                    <div>
                                        <label class="font-medium" for="gst">GST Number</label>
                                        <input type="text" id="gst" required class="form-input mt-1" placeholder="15-digit GSTIN">
                                        <div id="gst-error" class="error-message"></div>
                                    </div>
                                </div>

                                <div id="enrollment-section" class="hidden space-y-4 p-4 border border-yellow-300 rounded-lg bg-yellow-50">
                                    <div class="text-center">
                                        <p class="font-semibold text-gray-800">No GSTIN? No problem! Pehle hamari aasan guide dekhein.</p>
                                    </div>
                                    <a href="gst-guide-simple.html" target="_blank" class="inline-block text-center bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow">
                                        <i class="bi bi-box-arrow-up-right mr-2"></i>Step-by-Step Guide Dekhein
                                    </a>
                                    <p class="text-center text-xs text-gray-500">Guide naye tab mein khulegi.</p>
                                    <div>
                                        <label class="font-medium" for="enrollment-id">Enrollment ID</label>
                                        <input type="text" id="enrollment-id" required class="form-input mt-1" placeholder="Enter your Enrollment ID (ARN) here">
                                        <div id="enrollment-id-error" class="error-message"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div><label class="font-medium" for="pickup">Full Pickup Address</label><input type="text" id="pickup" required class="form-input mt-1" placeholder="Flat, Street, Area"></div>
                            <div class="flex gap-4">
                                <div class="w-1/2"><label class="font-medium" for="pincode">Pincode</label><input type="text" id="pincode" required class="form-input mt-1" placeholder="6-digit Pincode"></div>
                                <div class="w-1/2">
                                    <label class="font-medium" for="state">State</label>
                                    <select id="state" required class="form-input mt-1 bg-white">
                                        <option value="">Select State</option>
                                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                        <option value="Assam">Assam</option>
                                        <option value="Bihar">Bihar</option>
                                        <option value="Chandigarh">Chandigarh</option>
                                        <option value="Chhattisgarh">Chhattisgarh</option>
                                        <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                                        <option value="Delhi">Delhi</option>
                                        <option value="Goa">Goa</option>
                                        <option value="Gujarat">Gujarat</option>
                                        <option value="Haryana">Haryana</option>
                                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                                        <option value="Jharkhand">Jharkhand</option>
                                        <option value="Karnataka">Karnataka</option>
                                        <option value="Kerala">Kerala</option>
                                        <option value="Ladakh">Ladakh</option>
                                        <option value="Lakshadweep">Lakshadweep</option>
                                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                                        <option value="Maharashtra">Maharashtra</option>
                                        <option value="Manipur">Manipur</option>
                                        <option value="Meghalaya">Meghalaya</option>
                                        <option value="Mizoram">Mizoram</option>
                                        <option value="Nagaland">Nagaland</option>
                                        <option value="Odisha">Odisha</option>
                                        <option value="Puducherry">Puducherry</option>
                                        <option value="Punjab">Punjab</option>
                                        <option value="Rajasthan">Rajasthan</option>
                                        <option value="Sikkim">Sikkim</option>
                                        <option value="Tamil Nadu">Tamil Nadu</option>
                                        <option value="Telangana">Telangana</option>
                                        <option value="Tripura">Tripura</option>
                                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                                        <option value="Uttarakhand">Uttarakhand</option>
                                        <option value="West Bengal">West Bengal</option>
                                    </select>
                                </div>
                            </div>
                            <div><label class="font-medium" for="brandStory">Brand Story (Optional)</label><textarea id="brandStory" rows="3" class="form-input mt-1" placeholder="Tell customers about your brand and craft..."></textarea></div>
                            
                            <button type="submit" class="w-full mt-6 bg-yellow-400 hover:bg-yellow-500 text-black font-semibold py-2 px-4 rounded-lg shadow">Continue to Document Upload</button>
                        </form>
                    </div>

                    <div id="onboarding-step-3" class="hidden">
                         <h2 class="text-2xl font-bold text-center mb-4">Step 3: Bank & Documents</h2>
                         <form id="bankDetailsForm" class="space-y-4">
                            <div><label class="font-medium" for="account">Bank Account Number</label><input type="text" id="account" required class="form-input mt-1" placeholder="Enter valid account number"></div>
                            <div>
                                <label class="font-medium" for="ifsc">IFSC Code</label>
                                <input type="text" id="ifsc" required class="form-input mt-1" placeholder="E.g., SBIN0001234">
                                <div id="ifsc-error" class="error-message"></div>
                            </div>
                            <div id="gst-cert-upload-wrapper" class="space-y-2 pt-2">
                                <label class="font-medium">GSTIN Certificate <span class="text-red-500">*</span></label>
                                <div id="gst-cert-upload" class="file-upload-wrapper">
                                    <label for="gstin_file" class="cursor-pointer text-yellow-600 font-semibold">Choose File</label>
                                    <input type="file" id="gstin_file" class="hidden">
                                </div>
                            </div>
                            <div class="space-y-2">
                                <label class="font-medium">Cancelled Cheque <span class="text-red-500">*</span></label>
                                <div id="cheque-upload" class="file-upload-wrapper">
                                    <label for="cheque_file" class="cursor-pointer text-yellow-600 font-semibold">Choose File</label>
                                    <input type="file" id="cheque_file" required class="hidden">
                                </div>
                            </div>
                            <div id="pan-upload-wrapper" class="space-y-2">
                                <label class="font-medium">PAN Card (Optional)</label>
                                <div id="pan-upload" class="file-upload-wrapper">
                                    <label for="pan_file" class="cursor-pointer text-yellow-600 font-semibold">Choose File</label>
                                    <input type="file" id="pan_file" class="hidden">
                                </div>
                            </div>
                           
                            <button type="submit" class="w-full mt-6 bg-yellow-400 hover:bg-yellow-500 text-black font-semibold py-2 px-4 rounded-lg shadow">Submit Application âœ…</button>
                         </form>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="view-popups" class="hidden">
            <div id="success-popup" class="popup-overlay hidden">
                <div class="popup-card">
                    <h3 class="text-2xl font-bold mb-2">ðŸŽ‰ Onboarding Successful!</h3>
                    <p class="mb-4 text-gray-600">Welcome to Banjara Bazaar! Your application is submitted for verification. Let's list your first product now.</p>
                    <button id="show-add-product-popup" class="w-full bg-gray-700 hover:bg-gray-800 text-white font-semibold py-2 px-4 rounded-lg shadow">Let's Start</button>
                </div>
            </div>
            <div id="add-product-popup" class="popup-overlay hidden">
                <div class="popup-card">
                     <h3 class="text-2xl font-bold mb-2">ðŸš€ Add Your First Product</h3>
                    <p class="mb-4 text-gray-600">Our magical listing wizard makes it easy to add products in just a few minutes.</p>
                    <a href="listing_wizard.html" class="w-full inline-block text-center bg-yellow-400 hover:bg-yellow-500 text-black font-semibold py-2 px-4 rounded-lg shadow">Open Listing Wizard</a>
                </div>
            </div>
        </div>

    </div>

    <script>
        const navigateToView = (viewId) => {
            document.querySelectorAll('#app-container > div').forEach(view => view.classList.add('hidden'));
            document.getElementById(viewId).classList.remove('hidden');
        };

        const updateProgress = (stepNumber) => {
            const step1 = document.getElementById('progress-step-1');
            const step2 = document.getElementById('progress-step-2');
            const step3 = document.getElementById('progress-step-3');
            const line1 = document.getElementById('progress-line-1');
            const line2 = document.getElementById('progress-line-2');

            [step2, step3].forEach(s => { s.classList.remove('active', 'completed'); s.querySelector('.progress-circle').textContent = s.id.slice(-1); });
            [line1, line2].forEach(l => l.classList.remove('completed'));
            step1.querySelector('.progress-circle').textContent = 'âœ“';
            
            if (stepNumber === 2) {
                step2.classList.add('active');
                line1.classList.add('completed');
            } else if (stepNumber === 3) {
                step2.classList.add('completed');
                step2.querySelector('.progress-circle').textContent = 'âœ“';
                step3.classList.add('active');
                line1.classList.add('completed');
                line2.classList.add('completed');
            }
        };
        
        const gstInput = document.getElementById('gst');
        const gstError = document.getElementById('gst-error');
        const enrollmentIdInput = document.getElementById('enrollment-id');
        const ifscInput = document.getElementById('ifsc');
        const ifscError = document.getElementById('ifsc-error');
        const accountInput = document.getElementById('account');
        const gstinCertInput = document.getElementById('gstin_file');
        const panInput = document.getElementById('pan_file');
        const chequeInput = document.getElementById('cheque_file');


        gstInput.addEventListener('input', () => {
            const regex = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
            if (gstInput.value.length > 0 && !regex.test(gstInput.value.toUpperCase())) {
                gstError.textContent = 'Invalid GSTIN format.';
                gstInput.classList.add('invalid');
            } else {
                gstError.textContent = '';
                gstInput.classList.remove('invalid');
            }
        });

        ifscInput.addEventListener('input', () => {
            const regex = /^[A-Z]{4}0[A-Z0-9]{6}$/;
            if (ifscInput.value.length > 0 && !regex.test(ifscInput.value.toUpperCase())) {
                ifscError.textContent = 'Invalid IFSC code. It must be 11 characters.';
                ifscInput.classList.add('invalid');
            } else {
                ifscError.textContent = '';
                ifscInput.classList.remove('invalid');
            }
        });

        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            alert('OTP Sent! (Simulation)');
            navigateToView('view-onboarding');
            updateProgress(2);
        });

        document.getElementById('businessDetailsForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const hasGstin = document.getElementById('has-gstin').checked;
            const needsEnrollment = document.getElementById('need-enrollment').checked;
            let isValid = true;
            
            if (hasGstin) {
                if (gstInput.value.length === 0 || gstError.textContent !== '') {
                    isValid = false;
                    alert('Please enter a valid GSTIN before continuing.');
                }
            } else if (needsEnrollment) {
                if (enrollmentIdInput.value.length === 0) {
                    isValid = false;
                    alert('Please enter your Enrollment ID to continue.');
                }
            }

            if (isValid) {
                document.getElementById('onboarding-step-2').classList.add('hidden');
                document.getElementById('onboarding-step-3').classList.remove('hidden');
                updateProgress(3);
                updateDocumentMandatoryFields();
            }
        });

        document.getElementById('bankDetailsForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const hasGstin = document.getElementById('has-gstin').checked;
            let isValid = true;

            // Bank details validation
            if (accountInput.value.length === 0) {
                isValid = false;
                alert('Bank Account Number is mandatory.');
            } else if (ifscInput.value.length === 0 || ifscError.textContent !== '') {
                isValid = false;
                alert('Please enter a valid IFSC code before submitting.');
            }
            
            // Document validation based on GST option
            if (isValid && !chequeInput.files.length) {
                isValid = false;
                alert('Cancelled Cheque is mandatory.');
            } else if (isValid && hasGstin && !gstinCertInput.files.length) {
                isValid = false;
                alert('GSTIN Certificate is mandatory.');
            } else if (isValid && !hasGstin && !panInput.files.length) {
                isValid = false;
                alert('PAN Card is mandatory.');
            }

            if (isValid) {
                navigateToView('view-popups');
                document.getElementById('success-popup').classList.remove('hidden');
            }
        });

        document.getElementById('show-add-product-popup').addEventListener('click', () => {
            document.getElementById('success-popup').classList.add('hidden');
            document.getElementById('add-product-popup').classList.remove('hidden');
        });

        function setupFileUpload(inputId, wrapperId) {
            const fileInput = document.getElementById(inputId);
            const wrapper = document.getElementById(wrapperId);
            fileInput.addEventListener('change', () => {
                if (fileInput.files.length > 0) {
                    const file = fileInput.files[0];
                    wrapper.innerHTML = `<div class="file-preview">
                        <span class="truncate text-sm font-medium">ðŸ“„ ${file.name}</span>
                        <button type="button" class="ml-4 text-sm font-semibold text-red-600" onclick="resetUpload('${inputId}', '${wrapperId}')">Change</button>
                    </div>`;
                }
                updateMandatoryFileIndicator(inputId);
            });
        }
        
        function resetUpload(inputId, wrapperId) {
            document.getElementById(inputId).value = '';
            const wrapper = document.getElementById(wrapperId);
            wrapper.innerHTML = `<label for="${inputId}" class="cursor-pointer text-yellow-600 font-semibold">Choose File</label>`;
            updateMandatoryFileIndicator(inputId);
        }
        
        function updateMandatoryFileIndicator(inputId) {
            const fileInput = document.getElementById(inputId);
            const label = fileInput.closest('.space-y-2').querySelector('.font-medium');
            
            if (label) {
                if (fileInput.hasAttribute('required') && !fileInput.files.length) {
                    label.innerHTML = label.textContent.split('(')[0].trim() + ' <span class="text-red-500">*</span>';
                } else if (!fileInput.hasAttribute('required') && !fileInput.files.length) {
                    label.innerHTML = label.textContent.split('(')[0].trim() + ' (Optional)';
                } else {
                    label.innerHTML = label.textContent.split('(')[0].trim();
                }
            }
        }

        setupFileUpload('gstin_file', 'gst-cert-upload');
        setupFileUpload('cheque_file', 'cheque-upload');
        setupFileUpload('pan_file', 'pan-upload');
        
        const gstinSection = document.getElementById('gstin-section');
        const enrollmentSection = document.getElementById('enrollment-section');
        const hasGstinRadio = document.getElementById('has-gstin');
        const needEnrollmentRadio = document.getElementById('need-enrollment');
        
        const gstinCertLabel = document.querySelector('#gst-cert-upload-wrapper label');
        const panLabel = document.querySelector('#pan-upload-wrapper label');
        
        function toggleGstSections() {
            if (hasGstinRadio.checked) {
                gstinSection.classList.remove('hidden');
                enrollmentSection.classList.add('hidden');
                document.getElementById('gst').setAttribute('required', 'true');
                document.getElementById('enrollment-id').removeAttribute('required');
            } else if (needEnrollmentRadio.checked) {
                gstinSection.classList.add('hidden');
                enrollmentSection.classList.remove('hidden');
                document.getElementById('gst').removeAttribute('required');
                document.getElementById('enrollment-id').setAttribute('required', 'true');
            }
        }

        function updateDocumentMandatoryFields() {
            if (hasGstinRadio.checked) {
                gstinCertLabel.innerHTML = 'GSTIN Certificate <span class="text-red-500">*</span>';
                gstinCertInput.setAttribute('required', 'true');
                panLabel.innerHTML = 'PAN Card (Optional)';
                panInput.removeAttribute('required');
            } else {
                gstinCertLabel.innerHTML = 'GSTIN Certificate (Optional)';
                gstinCertInput.removeAttribute('required');
                panLabel.innerHTML = 'PAN Card <span class="text-red-500">*</span>';
                panInput.setAttribute('required', 'true');
            }
        }
        
        hasGstinRadio.addEventListener('change', toggleGstSections);
        needEnrollmentRadio.addEventListener('change', toggleGstSections);
        
        toggleGstSections();
        
        navigateToView('view-login');
    </script>
</body>
</html>
